DEBUG:root:network : simple_seq2seq
cuda_device : 0
seed : 0
spv_proportion : 100
truncated : False
act_size : 8
personality_size : 0
domain : e2e
dialog_path : data/dialogue/e2e-dataset/train.json
test_dialog_path : data/dialogue/e2e-dataset/test.json
dev_dialog_path : data/dialogue/e2e-dataset/test.json
condition_size : 42
slot_path : data/dialogue/e2e-dataset/slot_value.json
slot_max_ts : 21
text_max_ts : 82
slot_value_size : {'name': 1, 'eatType': 4, 'priceRange': 7, 'customer rating': 7, 'near': 1, 'food': 8, 'area': 3, 'familyFriendly': 3}
key_order : ['area', 'customer rating', 'eatType', 'familyFriendly', 'food', 'name', 'near', 'priceRange']
split : None
python_path : /home/huxu/anaconda3/envs/p3-torch13/bin/python
VAE : False
various_go : False
grad_clip_norm : 1.0
max_turn : 100
emb_size : 300
emb_trainable : True
hidden_size : 128
lr : 0.001
lr_decay : 1.0
batch_size : 128
dropout_rate : 0.0
epoch_num : 100
cuda : True
early_stop_count : 30
vocab_size : None
remove_slot_value : False
encoder_layer_num : 1
beam_search : False
beam_size : 10
beam_len_bonus : 0.5
teacher_force : 50
glove_path : ./data/glove.840B.300d.txt
model_path : ./models/simple_seq2seq_e2e_EL1.pkl
result_path : ./results/simple_seq2seq_e2e_EL1TMT82.csv
vocab_emb : ./vocabs/embedding_e2e.npy
vocab_path : ./vocabs/e2e.p

DEBUG:root:Device: 0
INFO:root:total trainable params: 3638352
INFO:root:Seq2Seq(
  (encoder): SimpleDynamicEncoder(
    (embedding): Embedding(3024, 300)
    (gru): GRU(300, 128, bidirectional=True)
  )
  (decoder): Simple_Decoder(
    (emb): Embedding(3024, 300)
    (attn_a): Attn(
      (attn): Linear(in_features=256, out_features=128, bias=True)
    )
    (attn_p): Attn(
      (attn): Linear(in_features=256, out_features=128, bias=True)
    )
    (gru): GRU(556, 128)
    (proj): Linear(in_features=384, out_features=3024, bias=True)
  )
  (dec_loss): NLLLoss()
)
INFO:root:embedding.  mean: 0.000241  std 0.511211
DEBUG:root:bucket 1 instance 42061
DEBUG:root:loss:8.020029067993164 grad:0.550166149682568
DEBUG:root:loss:7.858641624450684 grad:0.621912500098365
DEBUG:root:loss:7.640571594238281 grad:0.9012022807352149
DEBUG:root:loss:7.335898399353027 grad:1.277197230921372
DEBUG:root:loss:6.909972667694092 grad:1.633544873925907
DEBUG:root:loss:6.420133590698242 grad:1.8115947786422475
DEBUG:root:loss:5.8444905281066895 grad:1.8596902069627412
DEBUG:root:loss:5.392307758331299 grad:1.767681974605598
DEBUG:root:loss:5.104944229125977 grad:1.6623747966196238
DEBUG:root:loss:4.856715202331543 grad:1.4883851516411768
DEBUG:root:loss:4.833847999572754 grad:1.1679630210877983
DEBUG:root:loss:4.737810134887695 grad:0.8993592148686436
DEBUG:root:loss:4.711621284484863 grad:0.8342803037030071
DEBUG:root:loss:4.879126071929932 grad:1.1640616014196477
DEBUG:root:loss:4.790409564971924 grad:1.6212987502343148
DEBUG:root:loss:4.782533168792725 grad:1.8140483048111864
DEBUG:root:loss:4.791850566864014 grad:1.7218062404010204
DEBUG:root:loss:4.679966449737549 grad:1.343313140748414
DEBUG:root:loss:4.785399913787842 grad:0.945899509875771
DEBUG:root:loss:4.699034214019775 grad:0.5681314887943717
DEBUG:root:loss:4.777390480041504 grad:0.5419793313303396
DEBUG:root:loss:4.651632785797119 grad:0.71025841989064
DEBUG:root:loss:4.64188814163208 grad:0.6984798778866507
DEBUG:root:loss:4.645842552185059 grad:0.841431444545846
DEBUG:root:loss:4.65584135055542 grad:0.6966212558947116
DEBUG:root:loss:4.665206432342529 grad:0.6499908593983065
DEBUG:root:loss:4.470980167388916 grad:0.6785249856744103
DEBUG:root:loss:4.585509300231934 grad:0.5013878229973823
DEBUG:root:loss:4.522058010101318 grad:0.5175137921172197
DEBUG:root:loss:4.528812408447266 grad:0.49791553690705176
DEBUG:root:loss:4.652373790740967 grad:0.5049941418870324
DEBUG:root:loss:4.437351703643799 grad:0.5011245224920416
DEBUG:root:loss:4.591766834259033 grad:0.6052160761420736
DEBUG:root:loss:4.524020195007324 grad:0.556080868637997
DEBUG:root:loss:4.438443660736084 grad:0.48942902278996786
DEBUG:root:loss:4.417200565338135 grad:0.4507133901039668
DEBUG:root:loss:4.468960285186768 grad:0.5140701982989767
DEBUG:root:loss:4.522111892700195 grad:0.4911872900446392
DEBUG:root:loss:4.4726033210754395 grad:0.5083008647035202
DEBUG:root:loss:4.4619951248168945 grad:0.47713472363197307
DEBUG:root:loss:4.429460525512695 grad:0.4589826045601541
DEBUG:root:loss:4.401284217834473 grad:0.4483244712338804
DEBUG:root:loss:4.403159141540527 grad:0.42547615852545717
DEBUG:root:loss:4.326467514038086 grad:0.4805555168378548
DEBUG:root:loss:4.37874698638916 grad:0.3711218878128325
DEBUG:root:loss:4.331498146057129 grad:0.41928725845125825
DEBUG:root:loss:4.342160701751709 grad:0.34740058500119364
DEBUG:root:loss:4.396695137023926 grad:0.3914349484963675
DEBUG:root:loss:4.376016139984131 grad:0.43322276016763467
DEBUG:root:loss:4.312319755554199 grad:0.42509376934721216
DEBUG:root:loss:4.399249076843262 grad:0.46848938860447314
DEBUG:root:loss:4.256332874298096 grad:0.3906777917115331
DEBUG:root:loss:4.432190895080566 grad:0.46423867912505046
DEBUG:root:loss:4.234368324279785 grad:0.32743263738142503
DEBUG:root:loss:4.290614128112793 grad:0.40946309016784554
DEBUG:root:loss:4.239913463592529 grad:0.4142128129696419
DEBUG:root:loss:4.3151092529296875 grad:0.38566889818112005
DEBUG:root:loss:4.1714582443237305 grad:0.4405120611444807
DEBUG:root:loss:4.116974830627441 grad:0.4262533272109592
DEBUG:root:loss:4.194616794586182 grad:0.5068455814189129
DEBUG:root:loss:4.171238422393799 grad:0.42676614911918004
DEBUG:root:loss:4.265251636505127 grad:0.4304877763472079
DEBUG:root:loss:4.099325656890869 grad:0.4286072189830289
DEBUG:root:loss:4.202327251434326 grad:0.3764491129124534
DEBUG:root:loss:4.135218620300293 grad:0.517153556098362
DEBUG:root:loss:4.097940921783447 grad:0.4235961329333419
DEBUG:root:loss:4.123425483703613 grad:0.46161210380864115
DEBUG:root:loss:4.0472941398620605 grad:0.4349764440922599
DEBUG:root:loss:3.972958564758301 grad:0.4705870095527418
DEBUG:root:loss:3.923109769821167 grad:0.421556841147252
DEBUG:root:loss:4.0179572105407715 grad:0.4281846171850173
DEBUG:root:loss:4.023112773895264 grad:0.3666475316607895
DEBUG:root:loss:3.9982166290283203 grad:0.43812648102300644
DEBUG:root:loss:4.180830955505371 grad:0.3831662668068758
DEBUG:root:loss:3.848494291305542 grad:0.393169630638458
DEBUG:root:loss:3.9187138080596924 grad:0.42126213229697407
DEBUG:root:loss:3.8189265727996826 grad:0.4240843474968702
DEBUG:root:loss:3.949453830718994 grad:0.4072071945856031
DEBUG:root:loss:3.8562331199645996 grad:0.4231843740820367
DEBUG:root:loss:3.9293015003204346 grad:0.40182457613473055
DEBUG:root:loss:3.9439046382904053 grad:0.46859726871942653
DEBUG:root:loss:3.8824679851531982 grad:0.334615091477568
DEBUG:root:loss:3.767806053161621 grad:0.5442839821782743
DEBUG:root:loss:3.848637104034424 grad:0.42053746557061483
DEBUG:root:loss:3.8093879222869873 grad:0.3953512726941966
DEBUG:root:loss:3.8052706718444824 grad:0.5753602401873088
DEBUG:root:loss:3.8546009063720703 grad:0.3806693915578338
DEBUG:root:loss:3.7503905296325684 grad:0.436771877227494
DEBUG:root:loss:3.866488218307495 grad:0.42597555634929984
DEBUG:root:loss:3.741520404815674 grad:0.44542186377951976
DEBUG:root:loss:3.641765594482422 grad:0.4313567806266139
DEBUG:root:loss:3.75764536857605 grad:0.5504559939770635
DEBUG:root:loss:3.6649820804595947 grad:0.5087917111059733
DEBUG:root:loss:3.6835215091705322 grad:0.4556056754292176
DEBUG:root:loss:3.803162097930908 grad:0.44292388068166727
DEBUG:root:loss:3.681187152862549 grad:0.399471754658957
DEBUG:root:loss:3.6514503955841064 grad:0.38860763594500086
DEBUG:root:loss:3.6935224533081055 grad:0.4148698467439085
DEBUG:root:loss:3.7055256366729736 grad:0.4327925665449987
DEBUG:root:loss:3.4808194637298584 grad:0.3908883452244605
DEBUG:root:loss:3.6710829734802246 grad:0.39427199798593415
DEBUG:root:loss:3.652003526687622 grad:0.4576866271874691
DEBUG:root:loss:3.620692729949951 grad:0.41443556817451094
DEBUG:root:loss:3.7494308948516846 grad:0.4319232904068817
DEBUG:root:loss:3.4583961963653564 grad:0.41751052607157874
DEBUG:root:loss:3.6293821334838867 grad:0.3758239003396639
DEBUG:root:loss:3.5376596450805664 grad:0.362073933149521
DEBUG:root:loss:3.658297300338745 grad:0.4658783820361271
DEBUG:root:loss:3.551201105117798 grad:0.43198536357438905
DEBUG:root:loss:3.3558237552642822 grad:0.4040850941814336
DEBUG:root:loss:3.4610114097595215 grad:0.5133758745055509
DEBUG:root:loss:3.4791910648345947 grad:0.4643764446439497
DEBUG:root:loss:3.5285184383392334 grad:0.381757715780019
DEBUG:root:loss:3.453380584716797 grad:0.47066601718880674
DEBUG:root:loss:3.5437374114990234 grad:0.47148723050153357
DEBUG:root:loss:3.6609444618225098 grad:0.36107469040309126
DEBUG:root:loss:3.4136605262756348 grad:0.4602284793054952
DEBUG:root:loss:3.335806369781494 grad:0.41860603897349846
DEBUG:root:loss:3.296283006668091 grad:0.3690841429788853
DEBUG:root:loss:3.371922254562378 grad:0.4064711449513246
DEBUG:root:loss:3.224384069442749 grad:0.40806323629188423
DEBUG:root:loss:3.499363660812378 grad:0.3700854522469729
DEBUG:root:loss:3.3473997116088867 grad:0.41139614238413474
DEBUG:root:loss:3.334111452102661 grad:0.395933112447428
DEBUG:root:loss:3.534374713897705 grad:0.3984464008966816
DEBUG:root:loss:3.4315779209136963 grad:0.38835329974516314
DEBUG:root:loss:3.4383013248443604 grad:0.4178089035652508
DEBUG:root:loss:3.2454137802124023 grad:0.42301176091338644
DEBUG:root:loss:3.4397315979003906 grad:0.38916833341882207
DEBUG:root:loss:3.1871471405029297 grad:0.3785514439582622
DEBUG:root:loss:3.4198250770568848 grad:0.3716740842279442
DEBUG:root:loss:3.30710506439209 grad:0.40956645345862897
DEBUG:root:loss:3.3413665294647217 grad:0.36235740278835593
DEBUG:root:loss:3.16267728805542 grad:0.4064129550270703
DEBUG:root:loss:3.4222500324249268 grad:0.3554662598110199
DEBUG:root:loss:3.373849868774414 grad:0.377045769233631
DEBUG:root:loss:3.0221636295318604 grad:0.5162216328896987
DEBUG:root:loss:3.266824722290039 grad:0.42861763296054706
DEBUG:root:loss:3.09301495552063 grad:0.4217265816185721
DEBUG:root:loss:3.2951977252960205 grad:0.405740052436531
DEBUG:root:loss:2.9653496742248535 grad:0.39807447416588937
DEBUG:root:loss:2.859111785888672 grad:0.5209424195486341
DEBUG:root:loss:3.057783842086792 grad:0.36607073690985054
DEBUG:root:loss:3.0216662883758545 grad:0.386323358965923
DEBUG:root:loss:3.3318004608154297 grad:0.4993849669820996
DEBUG:root:loss:3.174879550933838 grad:0.3923164229537979
DEBUG:root:loss:3.3536605834960938 grad:0.3744510736598803
DEBUG:root:loss:3.3265528678894043 grad:0.4343036261633878
DEBUG:root:loss:3.3306169509887695 grad:0.3847956563061785
DEBUG:root:loss:3.030402898788452 grad:0.45473901637151726
DEBUG:root:loss:3.1319515705108643 grad:0.37707116434812066
DEBUG:root:loss:3.3589234352111816 grad:0.4445831757229828
DEBUG:root:loss:3.147278070449829 grad:0.4533020627666278
DEBUG:root:loss:3.1937577724456787 grad:0.3968932382751969
DEBUG:root:loss:3.2848987579345703 grad:0.42831393135224743
DEBUG:root:loss:3.2089083194732666 grad:0.3879263791051657
DEBUG:root:loss:3.0078554153442383 grad:0.39379699714713706
DEBUG:root:loss:2.957551956176758 grad:0.4561178411323876
DEBUG:root:loss:2.8446569442749023 grad:0.36330890520849846
DEBUG:root:loss:3.095750570297241 grad:0.35142566254428426
DEBUG:root:loss:3.3652851581573486 grad:0.5137344035853648
DEBUG:root:loss:3.4864919185638428 grad:0.39050571478091806
DEBUG:root:loss:2.982510805130005 grad:0.40382470596576076
DEBUG:root:loss:3.295489549636841 grad:0.4322381297268077
DEBUG:root:loss:2.993860960006714 grad:0.5209829721019343
DEBUG:root:loss:3.0936431884765625 grad:0.37590156800111585
DEBUG:root:loss:2.7358181476593018 grad:0.38317035951514034
DEBUG:root:loss:3.1191396713256836 grad:0.5489484423182207
DEBUG:root:loss:2.957632303237915 grad:0.42415873129503556
DEBUG:root:loss:3.221480131149292 grad:0.35951287783799696
DEBUG:root:loss:3.204164505004883 grad:0.4960478826969439
DEBUG:root:loss:2.8932175636291504 grad:0.5198885145846152
DEBUG:root:loss:3.0729548931121826 grad:0.38009812835347656
DEBUG:root:loss:3.2841615676879883 grad:0.41908316454787914
DEBUG:root:loss:3.1251797676086426 grad:0.417549080091141
DEBUG:root:loss:3.0104899406433105 grad:0.3730530648235416
DEBUG:root:loss:2.930896520614624 grad:0.38690525440244783
DEBUG:root:loss:3.0123987197875977 grad:0.3817796653554065
DEBUG:root:loss:3.1860191822052 grad:0.3765034706507195
DEBUG:root:loss:2.9653735160827637 grad:0.40828437638130216
DEBUG:root:loss:2.6745355129241943 grad:0.3541731339770717
DEBUG:root:loss:2.7920756340026855 grad:0.3795822530744076
DEBUG:root:loss:2.826618194580078 grad:0.4701496492607025
DEBUG:root:loss:2.816175937652588 grad:0.3231798926489457
DEBUG:root:loss:3.0848896503448486 grad:0.39732033902371183
DEBUG:root:loss:2.997626781463623 grad:0.33348604155180334
DEBUG:root:loss:2.756648540496826 grad:0.36588185730944145
DEBUG:root:loss:2.784468173980713 grad:0.42828488845274687
DEBUG:root:loss:2.796570062637329 grad:0.36188662388063586
DEBUG:root:loss:2.856811046600342 grad:0.3514421506228513
DEBUG:root:loss:2.824587345123291 grad:0.3521558277507386
DEBUG:root:loss:2.950993776321411 grad:0.4424525120932778
DEBUG:root:loss:2.938525438308716 grad:0.3771321870311275
DEBUG:root:loss:2.708207607269287 grad:0.3501953467386125
DEBUG:root:loss:3.1953179836273193 grad:0.36073578531724954
DEBUG:root:loss:2.766606569290161 grad:0.39892865800823557
DEBUG:root:loss:2.8448967933654785 grad:0.41197696237809284
DEBUG:root:loss:3.082934856414795 grad:0.3826930071922142
DEBUG:root:loss:3.1268889904022217 grad:0.5008438484337523
DEBUG:root:loss:3.0074896812438965 grad:0.5444607315641822
DEBUG:root:loss:3.4923057556152344 grad:0.40752348104458186
DEBUG:root:loss:2.752436637878418 grad:0.4774203647294034
DEBUG:root:loss:2.7639286518096924 grad:0.4567825219901657
DEBUG:root:loss:2.980628252029419 grad:0.39274140474828334
DEBUG:root:loss:2.8169031143188477 grad:0.40436737623858715
DEBUG:root:loss:2.626163959503174 grad:0.3661489373261554
DEBUG:root:loss:2.879579544067383 grad:0.34099929818169644
DEBUG:root:loss:2.961569309234619 grad:0.36477748205680594
DEBUG:root:loss:2.966538190841675 grad:0.3359268074494008
DEBUG:root:loss:2.9936037063598633 grad:0.34621260968712786
DEBUG:root:loss:2.86942720413208 grad:0.37172292723397854
DEBUG:root:loss:2.781607151031494 grad:0.3820951398535165
DEBUG:root:loss:3.0360593795776367 grad:0.37163049320672653
DEBUG:root:loss:2.7222461700439453 grad:0.43441715065818626
DEBUG:root:loss:2.849480628967285 grad:0.36836725278689414
DEBUG:root:loss:2.7853589057922363 grad:0.33983988153487993
DEBUG:root:loss:2.5927605628967285 grad:0.3281673798884089
DEBUG:root:loss:2.8229010105133057 grad:0.39859445469287547
DEBUG:root:loss:3.010657787322998 grad:0.33824870670912727
DEBUG:root:loss:3.0977253913879395 grad:0.3518946430866141
DEBUG:root:loss:2.598027467727661 grad:0.3851792386404808
DEBUG:root:loss:2.628527879714966 grad:0.30443814047552054
DEBUG:root:loss:2.883981227874756 grad:0.33693046768191953
DEBUG:root:loss:2.659653902053833 grad:0.31822661787705403
DEBUG:root:loss:3.267136573791504 grad:0.3908385097084873
DEBUG:root:loss:3.4443202018737793 grad:0.4400816369535096
DEBUG:root:loss:2.792393207550049 grad:0.43954725943261536
DEBUG:root:loss:2.775176525115967 grad:0.40605656788612304
DEBUG:root:loss:2.874955177307129 grad:0.3419706993157526
DEBUG:root:loss:2.7077348232269287 grad:0.3771914915469799
DEBUG:root:loss:2.7750792503356934 grad:0.3532492193535961
DEBUG:root:loss:3.132232666015625 grad:0.44128432673407636
DEBUG:root:loss:2.6360132694244385 grad:0.374984784666697
DEBUG:root:loss:3.0248873233795166 grad:0.4400295168090122
DEBUG:root:loss:2.7748188972473145 grad:0.3565428468614713
DEBUG:root:loss:3.014237642288208 grad:0.3987643421271119
DEBUG:root:loss:3.0842444896698 grad:0.373195290190627
DEBUG:root:loss:2.8362319469451904 grad:0.3673272675925476
DEBUG:root:loss:2.9069995880126953 grad:0.3681811198867223
DEBUG:root:loss:2.675676107406616 grad:0.3785082122012376
DEBUG:root:loss:2.990886926651001 grad:0.3089812222544608
DEBUG:root:loss:2.984619140625 grad:0.3564117806501383
DEBUG:root:loss:2.9032058715820312 grad:0.3470032298834377
DEBUG:root:loss:2.7248241901397705 grad:0.33937633682074086
DEBUG:root:loss:2.882126808166504 grad:0.3476365671069073
DEBUG:root:loss:2.6035115718841553 grad:0.3554350854448387
DEBUG:root:loss:2.7752606868743896 grad:0.42567362355616417
DEBUG:root:loss:2.74446702003479 grad:0.3592744948886692
DEBUG:root:loss:2.80753231048584 grad:0.3560039651127418
DEBUG:root:loss:3.1280524730682373 grad:0.38744583371587
DEBUG:root:loss:3.0700981616973877 grad:0.41209826958567775
DEBUG:root:loss:2.605698823928833 grad:0.47520095434382215
DEBUG:root:loss:2.803881883621216 grad:0.3787237569589398
DEBUG:root:loss:2.8619327545166016 grad:0.3689433477501791
DEBUG:root:loss:2.703049659729004 grad:0.422185343961058
DEBUG:root:loss:3.008484125137329 grad:0.4842262992381776
DEBUG:root:loss:3.2566535472869873 grad:0.3589111690518913
DEBUG:root:loss:2.707519769668579 grad:0.40441578508743276
DEBUG:root:loss:2.6065244674682617 grad:0.427632923043553
DEBUG:root:loss:2.4206204414367676 grad:0.36453038502093926
DEBUG:root:loss:2.7555203437805176 grad:0.30504807673895046
DEBUG:root:loss:2.4378631114959717 grad:0.3534709616326363
DEBUG:root:loss:2.7623651027679443 grad:0.3658394485080756
DEBUG:root:loss:2.5610363483428955 grad:0.33906025242357984
DEBUG:root:loss:2.399162769317627 grad:0.3132593314131095
DEBUG:root:loss:2.7880094051361084 grad:0.3452329144738422
DEBUG:root:loss:2.310591220855713 grad:0.34334786718548965
DEBUG:root:loss:2.5861103534698486 grad:0.3087251742453568
DEBUG:root:loss:2.9568874835968018 grad:0.3458548901838908
DEBUG:root:loss:2.7881364822387695 grad:0.3587654181012543
DEBUG:root:loss:2.5243539810180664 grad:0.34732546084464744
DEBUG:root:loss:2.798969030380249 grad:0.3242060906624539
DEBUG:root:loss:2.957462787628174 grad:0.3491123470371397
DEBUG:root:loss:2.8356246948242188 grad:0.35321746367086965
DEBUG:root:loss:2.635784149169922 grad:0.37299573866315644
DEBUG:root:loss:2.7693395614624023 grad:0.3548782891367853
DEBUG:root:loss:2.7050375938415527 grad:0.34612153771688586
DEBUG:root:loss:2.973756790161133 grad:0.3512203754879277
DEBUG:root:loss:2.476011276245117 grad:0.34860098687125246
DEBUG:root:loss:2.630274534225464 grad:0.398201763782914
DEBUG:root:loss:2.596423625946045 grad:0.32697294397906557
DEBUG:root:loss:2.7172605991363525 grad:0.35475625261283655
DEBUG:root:loss:2.5234415531158447 grad:0.3199564030452136
DEBUG:root:loss:2.724069356918335 grad:0.4042190388155063
DEBUG:root:loss:2.8124024868011475 grad:0.34928743134692153
DEBUG:root:loss:2.7107460498809814 grad:0.36101412447876086
DEBUG:root:loss:2.5683116912841797 grad:0.34221670222609385
DEBUG:root:loss:3.020590305328369 grad:0.3288735775016599
DEBUG:root:loss:2.595531940460205 grad:0.3670369657657091
DEBUG:root:loss:3.1738455295562744 grad:0.45018372773249166
DEBUG:root:loss:2.471525192260742 grad:0.4465863902290901
DEBUG:root:loss:2.594825029373169 grad:0.3560508357839769
DEBUG:root:loss:2.4662582874298096 grad:0.3457327953292297
